Infinity=Inf;
R=[2 5 20 24 31 32 36 48 64 73 96 97 127 128 129 163 191 192 229 255 256 257 319 320 321 417 479 480 511 512 ];

bllib_propD=[10.4858 66.1485 353.63 375.668 400.911 395.529 425.329 479.765 483.904 504.434 520.785 513.613 537.899 531.62 533.61 543.507 550.578 552.45 545.11 541.449 536.887 543.203 532.716 543.314 529.229 520.269 526.482 528.205 527.146 510.095  ];
bllib_mul1D=[5.27585 48.1882 315.836 345.79 378.369 378.078 400.216 435.562 488.064 507.457 495.065 499.774 524.386 516.222 513.6 533.015 543.834 536.077 530.052 530.604 521.234 527.366 521.998 504.123 513.804 495.807 493.943 502.691 491.918 466.844  ];
bllib_mul2D=[9.64208 81.92 426.25 439.791 451.941 432.96 477.757 500.536 553.475 561.061 523.682 525.043 566.904 562.168 560.768 554.336 575.411 569.792 565.129 552.712 553.475 543.187 549.617 566.798 545.586 527.358 539.397 536.204 539.123 536.871  ];

bllib_prop=[1.73797 3.30125 5.11364 5.26108 5.66101 5.67905 5.69637 3.95756 562.443 26.356 304.083 204.995 6.66901 580.472 549.618 447.079 420.725 616.339 509.01 461.409 620.679 590.439 472.18 613.214 591.317 542.15 546.103 597.8 515.686 580.405  ];
bllib_mul1=[1.01803 7.5156 43.9839 51.9478 5.82175 5.82542 5.85487 5.84949 483.667 37.7229 21.7363 13.8415 15.4595 547.827 504.176 313.184 405.403 584.497 492.676 453.508 603.226 584.072 472.171 606.113 584.772 537.124 542.727 585.918 508.316 550.637  ];
bllib_mul2=[1.02802 7.5156 44.8877 52.4288 5.86654 5.90747 5.91284 5.9729 488.064 37.7229 22.2926 14.075 112.048 542.294 513.6 313.184 405.403 588.292 495.855 449.664 606.634 584.072 480.915 613.202 591.306 542.144 546.098 589.824 508.316 547.827  ];

bllib_propC=[6.45278 34.3587 114.546 122.853 125.413 130.563 133.845 139.931 258.237 223.878 215.754 193.135 274.582 305.078 272.088 225.357 276.999 310.28 317.605 280.751 306.793 277.145 279.246 308.411 275.64 299.793 298.043 319.402 320.081 313.047  ]*2;
bllib_mul1C=[3.71177 29.5207 112.027 120.475 123.257 130.308 131.795 138.952 265.778 228.939 211.675 191.512 273.118 293.372 266.773 221.734 276.984 306.071 307.43 277.803 305.04 271.593 274.809 304.819 274.207 292.977 294.053 313.736 314.886 299.928  ]*2;
bllib_mul2C=[5.62994 42.0103 127.254 134.019 134.092 137.659 143.686 149.995 294.984 244.389 224.25 198.004 289.716 313.96 283.274 230.973 291.466 323.561 322.931 289.948 319.566 282.91 285.378 319.688 283.005 306.928 305.284 331.362 328.45 332.428  ]*2;

bllib_propZ=[12.9056 58.9824 215.946 227.279 242.134 242.306 251.839 246.401 260.744 265.669 269.692 270.166 274.582 273.947 272.088 274.444 271.932 274.551 270.635 269.35 265.786 270.25 271.226 270.955 268.644 271.075 274.544 274.127 275.832 268.773  ]*2;
bllib_mul1Z=[7.10899 50.0275 204.8 215.707 230.234 233.422 248.186 251.658 253.241 250.537 260.336 264.005 266.186 263.172 264.208 263.969 262.32 263.363 261.42 257.575 248.551 256.22 258.402 257.004 256.902 260.132 262.453 265.686 266.532 257.801  ]*2;
bllib_mul2Z=[10.4206 70.8497 240.499 251.658 262.417 255.653 271.068 268.038 272.523 270.989 283.116 281.499 281.928 281.084 283.274 277.168 276.984 281.357 278.469 279.265 279.62 277.136 277.748 281.875 277.078 277.557 280.006 280.423 282.398 281.453  ]*2;

at_propD=[15.5345 108.186 423.87 440.555 440.183 451.593 475.156 530.037 571.279 577.432 555.87 559.687 560.875 565.162 563.677 574.463 579.164 580.766 577.887 573.635 571.148 571.784 567.643 569.884 569.058 544.692 552.97 559.962 560.35 562.171 ];
at_mul1D=[15.3919 119.156 451.972 469.414 478.525 497.103 493.169 523.682 571.139 577.324 584.497 584.111 573.1 577.281 575.448 589.719 579.148 592.137 577.876 579.895 593.228 574.801 577.098 592.416 575.238 568.719 574.652 570.797 564.795 574.193 ];

at_propS=[1.14975 3.46328 5.54897 5.67214 6.10755 6.12905 6.12982 4.18992 658.898 27.9795 15.8072 9.86778 13.0064 654.761 528.448 119.216 437.212 666.172 537.475 473.761 654.731 631.622 494.66 651.296 622.616 568.723 570.923 614.403 539.125 631.615 ];
at_mul1S=[1.17159 8.48912 48.1882 56.9076 7.66482 7.69597 11.2679 11.3701 646.832 68.6816 40.957 26.4303 155.144 688.296 354.55 279.967 445.944 681.18 545.089 495.892 692.737 662.423 519.388 680.894 657.414 580.094 590.079 636.501 550.238 658.737 ];

at_propC=[7.48983 44.5473 128.823 138.345 137.248 143.689 144.887 149.073 296.686 249.018 229.966 201.439 289.734 317.694 286.242 230.982 293.392 321.275 328.457 293.156 323.421 290.479 291.794 323.638 289.193 311.044 307.959 327.076 326.942 333.461 ]*2;
at_mul1C=[6.76501 48.5452 129.774 138.952 136.34 144.32 144.775 149.008 296.614 248.971 233.497 204.951 291.326 319.566 289.238 234.888 295.327 328.25 334.163 298.092 329.369 293.615 293.44 327.68 290.779 315.268 311.779 333.863 333.582 336.596 ]*2;

at_propZ=[17.7725 84.6676 255.145 265.363 269.947 274.181 279.198 279.742 282.633 284.592 284.927 284.962 288.142 287.114 287.741 285.751 287.714 286.707 284.663 283.75 284.063 282.914 282.279 283.402 280.013 280.24 282.708 283.117 283.148 282.751 ]*2;
at_mul1Z=[15.9783 89.1646 254.509 263.363 271.164 272.523 281.034 279.62 293.372 286.585 290.375 290.241 292.953 291.778 290.768 293.299 291.466 290.375 286.782 286.813 287.097 287.401 283.819 286.496 283.005 281.599 283.162 284.024 284.278 284.812 ]*2;


clf reset;
colordef black;
hold on;


semilogx(R, bllib_prop,'r',R, bllib_mul1,'r--', R, bllib_mul2,'r*-');
semilogx(R, bllib_propD,'b', R, bllib_mul1D,'b--', R, bllib_mul2D,'b*-');
semilogx(R, bllib_propC,'g',R, bllib_mul1C,'g--', R, bllib_mul2C, 'g*-');
semilogx(R, bllib_propZ,'w',R, bllib_mul1Z,'w--', R, bllib_mul2Z, 'w*-');

semilogx(R, matlab_prop,'w', R, matlab_mul,'w.-');
semilogx(R, at_propD, 'm.-', R, at_mul1D, 'm*-');
semilogx(R, at_mul1S, 'yx-', R,at_propS, 'y-');
semilogx(R, at_propC, 'y--', R, at_mul1C, 'y^-');
semilogx(R, at_mul1Z, 'cx-', R, at_propZ, 'c--');



title('propagator(c=a*b*adjoint(a)) 700 MHz Pentium III Xeon');
xlabel('NxN');
ylabel('MFLOPS');
legend('BlochLib 1.0-S C=A.B.A''', 'BlochLib 1.0-S C=A*B', 'BlochLib 1.0--S C*=A','BlochLib 1.0-D C=A.B.A''', 'BlochLib 1.0-D C=A*B', 'BlochLib 1.0-D C*=A','BlochLib 1.0-C C=A.B.A''', 'BlochLib 1.0-C C=A*B', 'BlochLib 1.0-C C*=A', 'BlochLib 1.0-Z C=A.B.A''', 'BlochLib 1.0-Z C=A*B', 'BlochLib 1.0-Z C*=A','matlab-6.5-prop', 'matlab-6.5-C=A*B','ATLAS-3.4.2--D C=A.B.A''', 'ATLAS-3.4.2--D C=A.B','ATLAS-3.4.2--S C=A.B.A''', 'ATLAS-3.4.2--S C=A.B','ATLAS-3.4.2--C C=A.B.A''', 'ATLAS-3.4.2--C C=A.B','ATLAS-3.4.2--Z C=A.B.A''', 'ATLAS-3.4.2--Z C=A.B');

hold off;
