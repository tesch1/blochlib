
	<html>
	<head>
	
	<title>BlochLib::Documentation</title>
	
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<meta name="Author" content="Bo Blanton">
	<link rel="stylesheet" href="bloch.css" type="text/css">
	<script lanuage="javascript">function matchCont(contentsFile){
  if ((parent.menuTarg) && (parent.menuTarg.location.pathname.indexOf("47menu.html")
			== -1 )){
				parent.menuTarg.location.replace("47menu.html");
			  }
  if ((parent.titleTarg) && (parent.titleTarg.location.pathname.indexOf("47menu.html")
			== -1 )){
				parent.titleTarg.location.replace("47title.html");  } 
					}
</script>
<script lanuage="javascript">matchCont("47");</script>

		</head>

		<body bgcolor="#FFFFFF" text="#000000">
		<table width="98%" border="0" cellspacing="0" cellpadding="0" align="center" class="borderTD">
		  <tr>
			<td>&nbsp;</td>
		  </tr>
		</table>
		<table width="95%" border="0" cellspacing="0" cellpadding="0" align="center" class="main">
		  <tr>
			<td>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=center class='normalText'>
<tr><td class='subHeads'>
template&lt;class Grid_t&gt;<br />
class Biot:<br />
 public BiotCoil<br />
{....<br />
<HR height=1>
</td></tr>
<tr><td><blockquote>
This class contains the algorithms necessary to calculate Magnetic Fields on specific grid points using a coil as defined in BiotCoil object.  <br />
<br />
It is useful for single coils only.  The class 'MultiBiot' calculates fields generated by multiple coils, but does not store the field for each coil.  This class stores the magnetic fields for the individual coil.  Thus if you need just the field, and are not particular from which coil it came from, use the MultiBiot class. However, if you need to know the coil generated be each individual coil, then use a Vector of this class.<br />
<br />
</blockquote><HR height=1>
</td></tr>
<tr><td><HR height=1>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=left ><tr bgcolor='#ffffbb'><td>
<font size='+2'><a name='Public Vars'></a>Public Vars</font>
</td></tr></table>
<tr><td>
<a name='Public VarsBfield'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Vector&lt;coord&lt;&gt; &gt; Bfield;<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top><font color='#990000'>  IMPORTANT: </font></td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
You must call 'calculateField' or 'readShape' that has a saved Bfield for this to be of any size.<br />
</TT></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
This holds the calculated magnetic field.  Each point matches the order of the Grid Vector in the class.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
<font color='#006600'>//print out the grid points and the field</font><br />
XYZshape&lt;XYZfull&gt;::iterator it(g2);<br />
while(it){<br />
   cout&lt;&lt;it.Point()&lt;&lt;&quot; &quot;&lt;&lt;mycoil.Bfield[it.curpos()]&lt;&lt;endl;<br />
}<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='Public VarsController'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
MPIcontroller Controller<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
This is the Biot's MPI parallel controller.  If this is not set, the magnetic field calculation will NOT be performed in parallel.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
</TT></td></tr>
</table>
<tr><td><HR height=1>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=left ><tr bgcolor='#ffffbb'><td>
<font size='+2'><a name='Constructors'></a>Constructors</font>
</td></tr></table>
<tr><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot()<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
void<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Empty constructor.  Sets up an empty coil and an empty grid.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; coil;<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot(std::string fname, std::string sec=&quot;coil&quot;);<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
fname--&gt; a file name<br />
sec--&gt; the coil section you wish to load<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Attempts to read the coil named 'sec' from the parameters from a file names 'fname.' It also attempts to read the grid. <br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
<font color='#006600'>//The input file</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// coil{</font><br />
<font color='#006600'>//  type constant</font><br />
<font color='#006600'>//  constField 4,50,8</font><br />
<font color='#006600'>//}</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// grid{</font><br />
<font color='#006600'>//  min -1, -1, -1</font><br />
<font color='#006600'>//  max 1, 1, 1</font><br />
<font color='#006600'>//  dim 10, 10,10</font><br />
<font color='#006600'>//}</font><br />
<br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; myField(&quot;infile&quot;);<br />
</TT></td></tr>
</table>
<tr><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot(Parameters &pset, std::string sec=&quot;coil&quot;):<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
pset--&gt; a Parameters object<br />
sec--&gt; the coil section you wish to load<br />
<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Attempts to read the coil named 'sec' from the parameters from a file names 'fname.' It also attempts to read the grid. <br />
<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
<font color='#006600'>//The input file</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// TheCoil{</font><br />
<font color='#006600'>// type constant</font><br />
<font color='#006600'>// constField 4,50,8</font><br />
<font color='#006600'>//}</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// grid{</font><br />
<font color='#006600'>// min -1, -1, -1</font><br />
<font color='#006600'>// max 1, 1, 1</font><br />
<font color='#006600'>// dim 10, 10,10</font><br />
<font color='#006600'>//}</font><br />
Parameters pset(&quot;infile&quot;);<br />
<font color='#006600'>//this will read the 'grid' section as well</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; myField(pset, &quot;TheCoil&quot;);<br />
<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot(Grid_t &ingrid, Parameters &pset, std::string sec=&quot;coil&quot;):<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
ingrid--&gt; the grid<br />
pset--&gt; the Parameter file<br />
sec--&gt; the desired coil section<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Attempts to read the coil named 'sec' from the parameters from a file names 'fname.' It does NOT read the grid from the parameter file.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZShape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
</TT></td></tr>
</table>
<tr><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot(const BiotCoil &bc, const Grid_t &gg):<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
bc--&gt; a BiotCoil object<br />
gg--&gt; a Grid object<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Creates a Biot object from a already declared BiotCoil and a grid.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
BiotCoil coil(pset, &quot;mycoil&quot;);<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;&gt; &gt; mycoil(coil,g2);<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='ConstructorsBiot'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
Biot(const Biot &cp);<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
cp--&gt; another Biot with the same grid type<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
The copy constructor.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; myField(&quot;infile&quot;);<br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; cpopy(myField);<br />
</TT></td></tr>
</table>
<tr><td><HR height=1>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=left ><tr bgcolor='#ffffbb'><td>
<font size='+2'><a name='Assignments'></a>Assignments</font>
</td></tr></table>
<tr><td>
<a name='Assignmentsoperator='></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void operator=(const Biot&lt;Grid_t&gt; &rhs)<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
rhs--&gt; a Biot object<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Assigns one Biot of the same grid type to another.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil2=mycoil;<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='AssignmentssetGrid'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void setGrid(const Grid_t &ingr);<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
ingr--&gt; a object of the type 'Grid_t'<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Sets the grid.  It must be of the same type as Grid_t. <br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(pset, &quot;mycoil&quot;);<br />
mycoil.setGrid(g2);<br />
</TT></td></tr>
</table>
<tr><td><HR height=1>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=left ><tr bgcolor='#ffffbb'><td>
<font size='+2'><a name='IO'></a>IO</font>
</td></tr></table>
<tr><td>
<a name='IOread'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void read(std::string &fname,bool readgrid=true);<br />
void read(Parameters &pset, bool readgrid=true);<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
fname--&gt; a file name<br />
pset--&gt; a previously declared parameter set<br />
readgrid--&gt; if tru will try to read a 'grid' section from the Parmaeters<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Reads a file (if a string) or a parameter set.  However, this assumes that you have set the section in the BiotCoil superclass (using the Biot(pset, section) type constructors or by calling 'read(pset, section)').  If readgrid is true then it will try to read the section 'grid' from the Parmaeter input.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
<font color='#006600'>//The input file</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// coil{</font><br />
<font color='#006600'>// type constant</font><br />
<font color='#006600'>// constField 4,50,8</font><br />
<font color='#006600'>//}</font><br />
<font color='#006600'>//</font><br />
<font color='#006600'>// grid{</font><br />
<font color='#006600'>// min -1, -1, -1</font><br />
<font color='#006600'>// max 1, 1, 1</font><br />
<font color='#006600'>// dim 10, 10,10</font><br />
<font color='#006600'>//}</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; coil;<br />
Parameters pset(&quot;infile);<br />
coil.read(pset, &quot;coil&quot;); <font color='#006600'>//read the coil</font><br />
coil.read(pset); <font color='#006600'>//read the grid</font><br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='IOread'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void read(std::fstream &out);<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
out--&gt; an i/o stream (opened with ios::in flags)<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Reads a file in the 'BiotCoil' format. It does not write the Parameter set, but it reads the format as generated by 'BiotCoil::writeShape'<br />
<br />
If there is a magnetic field present it then attempts to read the magnetic field. Below is the format.<br />
-------------------<br />
START BiotCoil<br />
amps {num}<br />
loops {num}<br />
{x,y,z}<br />
{x,y,z}<br />
....<br />
END BiotCoil<br />
<br />
START BiotCoilBfield<br />
size 1000<br />
{bx,by,bz}<br />
{bx,by,bz}<br />
....<br />
END BiotCoilBfield<br />
------------------------<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
<font color='#006600'>//write the field out</font><br />
<font color='#006600'>// in the 'biot' format</font><br />
ostream out(&quot;outfile.biot&quot;);<br />
mycoil.write(out);<br />
<br />
<font color='#006600'>//read in a new object from the old one</font><br />
Biot&lt;&gt; mycoil2;<br />
ifstream in(&quot;outfile.biot&quot;);<br />
mycoil.read(in);<br />
</TT></td></tr>
</table>
<tr><td>
<a name='IOwrite'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void write(std::string fname);<br />
void write(std::fstream &out);<br />
<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
fname--&gt; a file name to dump the info<br />
out--&gt; a previously declared output stream<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Writes a Biot object as both the coil and the magnetic field (if there is any). In the format...<br />
<br />
-------------------<br />
START BiotCoil<br />
amps {num}<br />
loops {num}<br />
{x,y,z}<br />
{x,y,z}<br />
....<br />
END BiotCoil<br />
<br />
START BiotCoilBfield<br />
size 1000<br />
{bx,by,bz}<br />
{bx,by,bz}<br />
....<br />
END BiotCoilBfield<br />
------------------------<br />
<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Parameters pset(&quot;myfile&quot;);<br />
pset.addSection(&quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
<font color='#006600'>//write the field out</font><br />
<font color='#006600'>// in the 'biot' format</font><br />
ostream out(&quot;outfile.biot&quot;);<br />
mycoil.write(out);<br />
<br />
</TT></td></tr>
</table>
<tr bgcolor='#ffffff'><td>
<a name='IOwriteMatlab'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
void writeMatlab(std::string fname);<br />
void writeMatlab(matstream &out);<br />
<br />
<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top><font color='#990000'>  IMPORTANT: </font></td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
Matlab can only plot the data  with 'plotmag' if the Grid was RECTANGULAR. It can still read this output file however.<br />
</TT></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
fname--&gt; an output file name<br />
out--&gt; a previously declared matlab output stream<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Writes the data inside the object to several matlab variables to allow the matlab script 'plotmag' (in the folder 'matlabfunc' in the distribution) to plot the magnetic fields and coils.  The data format inside this class is not easily transcribed into a plotable matlab format, thus the data is reordered and reorganized as follows.<br />
<br />
B0 - the Bx field (a 1xN double array)<br />
B1 - the By field (a 1xN double array)<br />
B2 - the Bz field (a 1xN double array)<br />
<br />
P0 - the coil's x point (a 1xN array)<br />
P1 - the coil's y point (a 1xN array)<br />
P2 - the coil's z point (a 1xN array)<br />
<br />
pdiv - the indexs inside (P0,P1,P2) where new coils start<br />
<br />
grid0 - the grid's x points (a 1xN array)<br />
grid1 - the grid's y points (a 1xN array)<br />
grid2 - the grid's z points (a 1xN array)<br />
<br />
N -  the number of points total (constant)<br />
<br />
r - width of the grid (grid.max-grid-min) (a 1x3 array)<br />
<br />
res -  the resolution (the dx, dy, dz) (a 1x3 array)<br />
<br />
--------<br />
The matlab function the reassembles the data into valid<br />
3D arrays for each direction.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
<font color='#006600'>//dump data into a matlab file</font><br />
mycoil.writeMatlab(&quot;out.mat&quot;);<br />
<br />
</TT></td></tr>
</table>
<tr><td><HR height=1>
<table width="100%" border="0" cellspacing="0" cellpadding="0"  align=left ><tr bgcolor='#ffffbb'><td>
<font size='+2'><a name='Other Functions'></a>Other Functions</font>
</td></tr></table>
<tr><td>
<a name='Other FunctionscalculateField'></a><table width="80%" border="0" cellspacing="0" cellpadding="2"  align=center class='normalText'>
<tr bgcolor=''><td width='10%' valign=top><B><font color='#990000'> Function:</font></B> </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><B><TT>
bool calculateField();<br />
<br />
</TT></B></td></tr>
<tr><td width='10%'  valign=top> Input: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
void<br />
</td></tr>
<tr bgcolor=''><td width='10%'  valign=top> Description: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td>
Calculates the magnetic field on each grid point from the coil.  It will caluculate it in parallel if Controller is set. Returns false if something failed.<br />
</td></tr>
<tr><td width='10%'  valign=top> Example Usage: </td>
<td width=5  valign=top><HR width=5 size=5></td>
<td><TT>
<font color='#006600'>//set up our base rectangular grids</font><br />
Grid&lt;UniformGrid&gt; g1(coord&lt;&gt;(-1,-1,-1), coord&lt;&gt;(1,1,1), coord&lt;int&gt;(10,10,10));<br />
<br />
<font color='#006600'>//set up thte master shape</font><br />
XYZshape&lt;XYZfull&gt; g2(g1, XYZfull());<br />
<br />
<font color='#006600'>//set up our Biot field calculator class</font><br />
Biot&lt;XYZshape&lt;XYZfull&gt; &gt; mycoil(g2,pset, &quot;mycoil&quot;);<br />
<br />
<font color='#006600'>//set the MPIcontroler to be MPIworld</font><br />
mycoil.Controller=MPIworld;<br />
<br />
<font color='#006600'>//calculate the field</font><br />
mycoil.calculateField();<br />
<br />
</TT></td></tr>
</table>
</table>

	</td>
	  </tr>
	</table>
	<table width="95%" border="0" cellspacing="0" cellpadding="0" align="center">
	  <tr> 
		<td class="borderTD" >&nbsp;</td>
	  </tr>
	</table>

	<table width="90%" border="0" cellspacing="0" cellpadding="0" align="center">
	  <tr> 
		<td class="borderTD">&nbsp;</td>
	  </tr>
	</table>
	<table width="90%" border="0" cellspacing="0" cellpadding="0" align="center" class="smalltext">
	  <tr> 
		<td > 
		  <div align="left">all material copywrite &copy;2002 <a href="http://www.lbl.gov/" target="_new">LBL</a> 
		  </div>
		</td>
		<td >
		  <div align="center">Contact: <a href="mailto:magneto@dirac.cchem.berkeley.edu">Bo 
			Blanton</a></div>
		</td>

	  </tr>
	</table>
	<br></body>
	</html>
